<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Server Status</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .servers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .server-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .server-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
        }

        .server-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .server-name {
            font-size: 1.4rem;
            font-weight: 600;
            color: #2d3748;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-online {
            background: #48bb78;
            color: white;
        }

        .status-offline {
            background: #f56565;
            color: white;
        }

        .status-checking {
            background: #ecc94b;
            color: #2d3748;
        }

        .server-info {
            margin-top: 16px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            color: #718096;
            font-weight: 500;
        }

        .info-value {
            color: #2d3748;
            font-weight: 600;
        }

        .players-list {
            margin-top: 12px;
            padding: 12px;
            background: #f7fafc;
            border-radius: 8px;
            max-height: 150px;
            overflow-y: auto;
        }

        .player-item {
            padding: 4px 0;
            color: #4a5568;
        }

        .no-players {
            color: #a0aec0;
            font-style: italic;
        }

        .error-message {
            color: #f56565;
            font-size: 0.9rem;
            margin-top: 8px;
        }

        .add-server-btn {
            background: white;
            color: #667eea;
            border: 2px dashed #667eea;
            padding: 16px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.2s;
            width: 100%;
        }

        .add-server-btn:hover {
            background: #667eea;
            color: white;
            border-style: solid;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 32px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
        }

        .modal-header {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2d3748;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            margin-bottom: 6px;
            color: #4a5568;
            font-weight: 500;
        }

        .form-input, .form-select {
            width: 100%;
            padding: 10px;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            font-size: 1rem;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #667eea;
        }

        .modal-buttons {
            display: flex;
            gap: 12px;
            margin-top: 24px;
        }

        .btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: #cbd5e0;
        }

        .last-updated {
            text-align: center;
            color: white;
            opacity: 0.8;
            margin-top: 20px;
        }

        .refresh-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 10px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            margin: 0 auto;
            display: block;
            margin-bottom: 20px;
            transition: all 0.2s;
        }

        .refresh-btn:hover {
            background: white;
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üéÆ Game Server Status</h1>
            <p class="subtitle">Track your favorite game servers in real-time</p>
        </header>

        <button class="refresh-btn" onclick="refreshAll()">üîÑ Refresh All</button>

        <div class="servers-grid" id="serversGrid">
            <!-- Server cards will be added here -->
        </div>

        <button class="add-server-btn" onclick="openModal()">+ Add Server</button>

        <div class="last-updated" id="lastUpdated"></div>
    </div>

    <!-- Add Server Modal -->
    <div class="modal" id="addServerModal">
        <div class="modal-content">
            <h2 class="modal-header">Add New Server</h2>
            <div class="form-group">
                <label class="form-label">Server Name</label>
                <input type="text" class="form-input" id="serverName" placeholder="My Minecraft Server">
            </div>
            <div class="form-group">
                <label class="form-label">Game Type</label>
                <select class="form-select" id="serverType">
                    <option value="minecraft-java">Minecraft Java Edition</option>
                    <option value="minecraft-bedrock">Minecraft Bedrock Edition</option>
                </select>
            </div>
            <div class="form-group">
                <label class="form-label">Server Address</label>
                <input type="text" class="form-input" id="serverAddress" placeholder="mc.example.com:25565">
            </div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal()">Cancel</button>
                <button class="btn btn-primary" onclick="addServer()">Add Server</button>
            </div>
        </div>
    </div>

    <script>
        // Load servers from localStorage
        let servers = JSON.parse(localStorage.getItem('gameServers')) || [];

        function saveServers() {
            localStorage.setItem('gameServers', JSON.stringify(servers));
        }

        function openModal() {
            document.getElementById('addServerModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('addServerModal').classList.remove('active');
            document.getElementById('serverName').value = '';
            document.getElementById('serverAddress').value = '';
        }

        function addServer() {
            const name = document.getElementById('serverName').value.trim();
            const type = document.getElementById('serverType').value;
            const address = document.getElementById('serverAddress').value.trim();

            if (!name || !address) {
                alert('Please fill in all fields');
                return;
            }

            servers.push({
                id: Date.now(),
                name: name,
                type: type,
                address: address,
                status: null
            });

            saveServers();
            closeModal();
            renderServers();
            checkServer(servers[servers.length - 1]);
        }

        function removeServer(id) {
            if (confirm('Are you sure you want to remove this server?')) {
                servers = servers.filter(s => s.id !== id);
                saveServers();
                renderServers();
            }
        }

        async function checkMinecraftServer(server) {
            try {
                // Using mcsrvstat.us API for Minecraft server status
                const apiUrl = server.type === 'minecraft-java' 
                    ? `https://api.mcsrvstat.us/3/${server.address}`
                    : `https://api.mcstatus.io/v2/status/bedrock/${server.address}`;

                const response = await fetch(apiUrl);
                const data = await response.json();

                if (server.type === 'minecraft-java') {
                    if (data.online) {
                        return {
                            online: true,
                            players: {
                                online: data.players.online,
                                max: data.players.max,
                                list: data.players.list || []
                            },
                            version: data.version,
                            motd: data.motd?.clean?.[0] || 'No MOTD',
                            ping: data.debug?.ping || 'N/A'
                        };
                    } else {
                        return { online: false };
                    }
                } else {
                    // Bedrock handling
                    if (data.online) {
                        return {
                            online: true,
                            players: {
                                online: data.players.online,
                                max: data.players.max,
                                list: []
                            },
                            version: data.version?.name,
                            motd: data.motd?.clean || 'No MOTD'
                        };
                    } else {
                        return { online: false };
                    }
                }
            } catch (error) {
                console.error('Error checking server:', error);
                return { online: false, error: error.message };
            }
        }

        async function checkServer(server) {
            const serverIndex = servers.findIndex(s => s.id === server.id);
            servers[serverIndex].checking = true;
            renderServers();

            const status = await checkMinecraftServer(server);
            servers[serverIndex].status = status;
            servers[serverIndex].checking = false;
            servers[serverIndex].lastChecked = new Date().toISOString();
            
            saveServers();
            renderServers();
        }

        function renderServers() {
            const grid = document.getElementById('serversGrid');
            grid.innerHTML = '';

            servers.forEach(server => {
                const card = document.createElement('div');
                card.className = 'server-card';

                let statusBadge = '';
                let serverInfo = '';

                if (server.checking) {
                    statusBadge = '<span class="status-badge status-checking">Checking...</span>';
                } else if (server.status === null) {
                    statusBadge = '<span class="status-badge status-checking">Not Checked</span>';
                } else if (server.status.online) {
                    statusBadge = '<span class="status-badge status-online">Online</span>';
                    
                    serverInfo = `
                        <div class="server-info">
                            <div class="info-row">
                                <span class="info-label">Players</span>
                                <span class="info-value">${server.status.players.online}/${server.status.players.max}</span>
                            </div>
                            ${server.status.version ? `
                            <div class="info-row">
                                <span class="info-label">Version</span>
                                <span class="info-value">${server.status.version}</span>
                            </div>
                            ` : ''}
                            ${server.status.ping ? `
                            <div class="info-row">
                                <span class="info-label">Ping</span>
                                <span class="info-value">${server.status.ping}ms</span>
                            </div>
                            ` : ''}
                        </div>
                    `;

                    if (server.status.players.list && server.status.players.list.length > 0) {
                        serverInfo += `
                            <div class="players-list">
                                <div style="font-weight: 600; margin-bottom: 8px; color: #2d3748;">Online Players:</div>
                                ${server.status.players.list.map(player => 
                                    `<div class="player-item">‚Ä¢ ${player}</div>`
                                ).join('')}
                            </div>
                        `;
                    } else if (server.status.players.online > 0) {
                        serverInfo += `
                            <div class="players-list">
                                <div class="no-players">Player list not available</div>
                            </div>
                        `;
                    }
                } else {
                    statusBadge = '<span class="status-badge status-offline">Offline</span>';
                    if (server.status.error) {
                        serverInfo = `<div class="error-message">Error: ${server.status.error}</div>`;
                    }
                }

                card.innerHTML = `
                    <div class="server-header">
                        <h3 class="server-name">${server.name}</h3>
                        ${statusBadge}
                    </div>
                    <div style="color: #718096; font-size: 0.9rem; margin-bottom: 8px;">
                        üìç ${server.address}
                    </div>
                    ${serverInfo}
                    <div style="margin-top: 16px; display: flex; gap: 8px;">
                        <button class="btn btn-primary" onclick="checkServer(servers.find(s => s.id === ${server.id}))" style="flex: 1;">
                            Refresh
                        </button>
                        <button class="btn btn-secondary" onclick="removeServer(${server.id})" style="flex: 0;">
                            üóëÔ∏è
                        </button>
                    </div>
                `;

                grid.appendChild(card);
            });

            updateLastChecked();
        }

        function updateLastChecked() {
            const lastUpdated = document.getElementById('lastUpdated');
            const now = new Date().toLocaleString();
            lastUpdated.textContent = `Last updated: ${now}`;
        }

        function refreshAll() {
            servers.forEach(server => checkServer(server));
        }

        // Initial render and check
        renderServers();
        refreshAll();

        // Auto-refresh every 30 seconds
        setInterval(refreshAll, 30000);
    </script>
</body>
</html>
